<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <title>HealthySurprise</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="stylesheet" href="/styles.css" />
    <link
      href="https://fonts.googleapis.com/css?family=Maven+Pro|Yrsa|Press+Start+2P"
      rel="stylesheet"
    />
    <meta name="theme-color" content="#fafafa" />
  </head>

  <body>
	<style>
      .github-corner:hover .octo-arm {
        animation: octocat-wave 560ms ease-in-out;
      }
      @keyframes octocat-wave {
        0%,
        100% {
          transform: rotate(0);
        }
        20%,
        60% {
          transform: rotate(-25deg);
        }
        40%,
        80% {
          transform: rotate(10deg);
        }
      }
      @media (max-width: 500px) {
        .github-corner:hover .octo-arm {
          animation: none;
        }
        .github-corner .octo-arm {
          animation: octocat-wave 560ms ease-in-out;
        }
      }
    </style>
    <p class="successMsg" role="alert" hidden>Surprise sent...</p>
    <p class="errorMsg" role="alert" hidden>Something went wrong...</p>
    <form name="contact" class="form" method="POST" data-netlify="true">
      <h1>Want to send healthy surprise to your friends ?</h1>
      <button class="btn" type="submit">Send Surprise!</button>
    </form>

    <script>
      const form = document.querySelector('form');
      form.addEventListener('submit', async event => {
        event.preventDefault();

        // enable local testing
        const IS_PRODUCTION = !/127\.0\.0\.1/.test(window.location);
        const SUBMISSION_URL = IS_PRODUCTION
          ? '/'
          : 'http://127.0.0.1:9000/submission-created';

        // disable button to prevent multiple submissions
        form.querySelector('button').disabled = true;

        try {
          const response = await fetch(SUBMISSION_URL, {
            method: 'post',
            headers: {
              'Content-type': 'application/x-www-form-urlencoded; charset=UTF-8'
            },
            body: new URLSearchParams(new FormData(form)).toString()
          });

          if (response.status === 200) {
            document.querySelector('.successMsg').hidden = false;
          } else {
            document.querySelector('.errorMsg').hidden = false;
          }
        } catch (e) {
          console.error(e);
        }
      });
    </script>
  </body>
</html>
